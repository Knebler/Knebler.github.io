<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,
				initial-scale=1.0">
				
	<title>AZoom Rentals and Services</title>
	<link rel="stylesheet" href="css/generalstylesheet.css">
	<link rel="stylesheet" href="css/paymentstylesheet.css">
</head>

<body>
    <section id="pageHead">
        <div class="topContainer">
			<button class="coyLogoImg" onclick="homePageOpen()"><img src="img\companylogo.png" alt="Company Logo"></button>

			<div class="topIcons">
				<button class="dropdownIcons" id="accountLogo" onclick="accountPageOpen()"><img src="img\account.png" alt="Account Button" ></button> <!-- Add dropdown menu to show currently logged in user, if none just display a prompt for the visitor to register or log in -->
					<div class="dropdownMenu">
						<img src="" class="accountDropdownUserDispImg">
						<h2 class="accountDropdownUserStatus">Guest</h2>
					</div>
			</div>
			<div class="topIcons">
				<button class="dropdownIcons" id="cartLogo" onclick="cartPageOpen()"><img src="img\grocery-store.png" alt="Cart Button"></button>
				<div class="cartItemContainer">
					<h2 id="cartItemDisplay"></h2>
				</div>
			</div>
			<div class="topIcons">
				<button class="dropdownIcons" id="searchLogo" onclick="searchPageOpen()"><img src="img\search.png" alt="Search Button"></button>
				<div class="dropdownMenu">
					
				</div>
			</div>
		</div>

        <div id="navBarContainer">
			<ul class="headerNavBar">
				<li><a href="homepage.html">Home Page</a></li>
				<li><a href="rentals.html">Rental Library</a></li> <!-- Add dropdown menu to show subcategories which reflect available options on the page itself -->
				<li class="headerNavBarRightMostLeft"><a href="services.html">Service Listings</a></li> <!-- Same thing here -->
				<li class="headerNavBarAbout"><a href="about.html">About</a></li>
			</ul>
		</div>
    </section>

    <section id="pageBody">
        <div class="paymentDetailsUpper">
            <div class="returnContainer">
                <button class="returnToCart" onclick="cartPageOpen()">Back to Cart</button>
            </div>

            <div class="locationSelectContainer">
                <h1>Location Select</h1>
                <form class="locationField">
                    <label for="locationTypeSelect">Choose the pickup location:</label>
                    <select name="locationTypeSelect" id="locationTypeSelect" onchange="">
                        <option value="location1">AZoom Branch 1</option>
                        <option value="location2">AZoom Branch 2</option>
                    </select>
                </form>
            </div>
            <div class="detailFieldsContainer">
                <h1>Billing</h1>
                <form class="detailField">
                    <label for="fFirstName">First Name:</label>
                    <input type="text" id="fFirstName" required>
                    <label for="fLastName">Last Name:</label>
                    <input type="text" id="fLastName" required><br>
                    <label for="fAddress">Address Line 1:</label>
                    <input type="text" id="fAddress" required><br>
                    <label for="fAddressCont">Address Line 2:</label>
                    <input type="text" id="fAddressCont" required><br>
                    <label for="fEmail">Email:</label>
                    <input type="text" id="fEmail" required>
                </form>		
            </div>

        </div>

        <div class="paymentDetailsLower">
            <div class="cartReviewContainer">
                <h1>Order Overview</h1>
                <div id="cartReviewDispContainer">
                    <div class="singleCartDisplayContainer" id="singleCartDisplayContainerBase">
                      <img src="img/vehicles/Toyota/Alphard_Details/vehicle_toyota_alphard_4.png" class="itemDisplay">
                        <h2 class="titleDisplay"></h2>
                        <h2 class="dateTimeRange"> Range of selected dates and times here </h2>
                        <h2 class="costDisplay"> Calculated cost here </h2>
                    </div>
                </div>
            </div>
            <div class="totalCostContainer">
                <h1>Total cost: To be determined</h1>
            </div>
            <div class="paymentFieldsContainer">
                <h1>Payment Info</h1>
                <div id="creditCardFieldsContainer">
                    <form class="cCardField">
                        <label for="fFullName">Name On Card: </label><br>
                        <input type="text" id="fFullName" placeholder="Full Name on Card" required><br>
                        <label for="fCCNumber">Card Number: </label><br>
                        <input type="tel" pattern="\d*" maxlength="19" placeholder="Card Number" id="fCCNumber" required><br>
                        <label for="fCExpiry">Card Expiry: </label><br>
                        <input type="tel" pattern="\d*" maxlength="7" placeholder="MM / YY" id="fCExpiry" required>
                        <label for="fCVC">CVC/CVV: </label>
                        <input type="tel" pattern="\d*" maxlength="4" placeholder="***" id="fCVC" required><br>
                    </form>
                </div>
            </div>
            <button class="detailsConfirm" onclick="addToAccount(), resetCart(), thanksPageOpen()">PROCEED</button>
        </div>
    </section>
</body>

<footer>
    <section class="footerContainer">
		<div class="footerLinkContainer">
			<ul class="footerNavBar"> <!-- Add in footer appendix links for legal purposes -->
				<li><a href="#"><h3>Business Certificate</h3></a></li>
				<li><a href="#"><h3>Legal</h3></a></li>
				<li><a href="#"><h3>Staff Portal</h3></a></li>
				<li><a href="#"><h3>References</h3></a></li>
			</ul>
		</div>
		
		<div class="footerSocMedandPayContainer">
			<div class="footerSocMedLinks">
				<a href="https://www.whatsapp.com/"><img src="img/whatsapp.png" class="socialMediaLogo"></a>
				<a href="https://www.instagram.com/"><img src="img/instagram.png" class="socialMediaLogo"></a>
				<a href="https://www.facebook.com/"><img src="img/facebook.png" class="socialMediaLogo"></a>
				<a href="https://x.com/"><img src="img/twitter.png" class="socialMediaLogo"></a>
			</div>
			
			<div class="footerPaymentLogos">
				<img src="img/paylogos/visa.svg" class="paymentLogo">
				<img src="img/paylogos/mastercard.svg" class="paymentLogo">
				<img src="img/paylogos/american-express.svg" class="paymentLogo">
				<img src="img/paylogos/payment badge_white.svg" class="paymentLogo">
			</div>
		</div>
		

		
		<div class="footerCopyrightContainer">
			<h4> No copyright @ 2024 </h4>
		</div>
	</section>
</footer>

<script>
    // Variable Initialization
    const cAccHeader = "cAccountUsername";
    const cCartHeader = "cCartItems";
    let cartCount = document.getElementById("cartItemDisplay");
    let cartItemArray = [];
    let accountItemArray = [];
    let displayTemplate = document.getElementById("singleCartDisplayContainerBase");
    let cartDisplayParent = document.getElementById("cartReviewDispContainer");
    

    //Logic
    updateCartNumber();
    for (let i = 0; i < cartItemArray.length; i++)	
	{
		//console.log(cartItemArray[i]);
		if (cartItemArray[i] != "")
		{
			constructCartCard(cartItemArray[i]);
		}
	}


    //Functions
	function openDirectLink(linkString)
	{
		window.location.href = linkString;
	}
	
	function homePageOpen()
	{
		openDirectLink("homepage.html");
	}

    function accountPageOpen()
	{
		openDirectLink("loginandregister.html");
	}

    function cartPageOpen()
    {
        openDirectLink("cart.html")
    }

    function thanksPageOpen()
    {
        openDirectLink("thankyou.html");
    }

    function getCartStatus()
    {
		let cookieName = cCartHeader + "=";
		let decodedCookie = decodeURIComponent(document.cookie);

		let ca = decodedCookie.split(";");
		for (let i = 0; i < ca.length; i++)	
		{
			let c = ca[i];
			while (c.charAt(0) == ' ')
			{
				c = c.substring(1);
			}
			if (c.indexOf(cookieName) == 0) 
			{
				return c.substring(name.length, c.length);
			}
		}
		return "";
	}

    function updateCartNumber()
    {
        let cCartItems = getCartStatus(cCartHeader);
		let ca = cCartItems.split("=");
		let count = 0;
		if (ca[1] != "")
		{
       		count = ca[1].split(",").length;
		}
     //   console.log(count);
        cartCount.innerHTML = count;
		getCartArray();
        return;
    }

    function getCartArray()
	{
		let cCartItems = getCartStatus(cCartHeader).split("=");
		//console.log(cCartItems);
		let cCTemp = cCartItems[1];
		// cCartItems[1] contains the important data
		//console.log(cCartItems);
		if (cCTemp != "")
		{
			let cSplitterTemp = cCTemp.split(",").map(item => item.trim())
			//console.log(cSplitterTemp);
			cartItemArray = cSplitterTemp;
			
		}
	}

    function constructCartCard(itemArray)
	{
		let singleCardArray = itemArray.split(".").map(item => item.trim());
	//	console.log(singleCardArray);

		let itemType = singleCardArray[0];
		let itemStartPeriod = singleCardArray[1];
		let itemEndPeriod = singleCardArray[2];
	//	console.log(displayTemplate);

		let clone = displayTemplate.cloneNode(true);
		clone.style.display = "block";
		for (let i = 0; i < clone.childNodes.length; i++)
		{
			switch (clone.childNodes[i].className)
			{
				case "itemDisplay":
					switch (itemType)
					{
						case "atto3":
							clone.childNodes[i].src = "img/vehicles/BYD/BYD_ATTO3.png";
							break;
						case "dolphin":
							clone.childNodes[i].src = "img/vehicles/BYD/BYD_DOLPHIN.png";
							break;
						case "han":
							clone.childNodes[i].src = "img/vehicles/BYD/BYD_HAN.png";
							break;
						case "sealuev":
							clone.childNodes[i].src = "img/vehicles/BYD/BYD_SEAL_U_EV.png";
							break;
						case "seal":
							clone.childNodes[i].src = "img/vehicles/BYD/BYD_SEAL.png";
							break;
						case "sealion":
							clone.childNodes[i].src = "img/vehicles/BYD/BYD_SEALION_7.png";
							break;
						case "tang":
							clone.childNodes[i].src = "img/vehicles/BYD/BYD_TANG_2024.png";
							break;
					}
					break;
				case "titleDisplay":
					switch (itemType)
					{
						case "atto3":
							clone.childNodes[i].innerHTML = "BYD Atto 3";
							break;
						case "dolphin":
							clone.childNodes[i].innerHTML = "BYD Dolphin";
							break;
						case "han":
							clone.childNodes[i].innerHTML = "BYD Han";
							break;
						case "sealuev":
							clone.childNodes[i].innerHTML = "BYD Seal U EV";
							break;
						case "seal":
							clone.childNodes[i].innerHTML = "BYD Seal";
							break;
						case "sealion":
							clone.childNodes[i].innerHTML = "BYD Sealion";
							break;
						case "tang":
							clone.childNodes[i].innerHTML = "BYD Tang 2024";
							break;
					}
					break;
				case "dateTimeRange":
					clone.childNodes[i].innerHTML ="Selected Rental Period: " + itemStartPeriod + "--" + itemEndPeriod;
					break;
				case "costDisplay":
					
					break;
				default:
					break;
			}
		}
		cartDisplayParent.appendChild(clone);
		
	}

    function getAccountStatus()
    {
		let cookieName = cAccHeader + "=";
		let decodedCookie = decodeURIComponent(document.cookie);

		let ca = decodedCookie.split(";");
		for (let i = 0; i < ca.length; i++)	
		{
			let c = ca[i];
			while (c.charAt(0) == ' ')
			{
				c = c.substring(1);
			}
			if (c.indexOf(cookieName) == 0) 
			{
				return c.substring(name.length, c.length);
			}
		}
		return "";
	}

    function addToAccount()
    {
        let cAccountStatusTemp = getAccountStatus();

        const d = new Date();
        d.setTime(d.getTime() + (5*24*60*60*1000));
        let expires = "expires=" + d.toUTCString();

        if (cAccountStatusTemp != "")
        {
            let cTemp = getCartStatus().split("=");
            if (cTemp[1] != "")
            {
                document.cookie = cAccHeader + "=" + cTemp[1] + ";" + expires + ";path=/";
            }
            else
            {
				document.cookie = cAccountStatusTemp + cTemp[1] + ";" + expires + ";path=/";
            }
        }
        else
        {
			document.cookie = cAccHeader + "=" + cTemp[1] + ";" + expires + ";path=/";
        }
    }

    function resetCart()
	{
		let cookieName = cCartHeader + "=";
		document.cookie = cookieName;
	}

	function resetAccount()
	{
		let cookieName = cAccHeader + "=";
		document.cookie = cookieName;
	}

    function getAccountArray()
	{
		let cAccItems = getCartStatus(cAccHeader).split("=");
		//console.log(cCartItems);
		let cCTemp = cAccItems[1];
		// cCartItems[1] contains the important data
		//console.log(cCartItems);
		if (cCTemp != "")
		{
			let cSplitterTemp = cCTemp.split(",").map(item => item.trim())
			//console.log(cSplitterTemp);
			accountItemArray = cSplitterTemp;
		}
	}

</script>

</html>